<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Firebase Hosting クイックスタート</title>
  <style>
    body { font-family: "Segoe UI","Hiragino Kaku Gothic ProN","Yu Gothic",Meiryo,Arial,sans-serif; background:#fff; color:#111; line-height:1.75; margin:0; }
    main { max-width: 960px; margin: 24px auto; padding: 24px; border:1px solid #e5e7eb; border-radius:12px; box-shadow:0 2px 6px rgba(0,0,0,.06); background:#fff; }
    h1,h2,h3 { color:#0b4a6f; margin:0 0 12px; }
    h2 { margin-top:24px; }
    p { margin: 0 0 12px; }
    ul { margin: 8px 0 12px 20px; }
    pre { background:#fff; color:#111; border:1px solid #cbd5e1; border-radius:8px; padding:12px; overflow:auto; }
    pre code { background:none; font-family: Consolas, Menlo, Monaco, "Courier New", monospace; font-size:15px; line-height:1.35; white-space:pre; display:block; }
    table { width:100%; border-collapse:collapse; margin: 12px 0; font-size: 14px; }
    th, td { border:1px solid #e5e7eb; padding:8px; text-align:left; vertical-align:top; }
    th { background:#f1f5f9; }
    .card { border:1px solid #e5e7eb; border-radius:12px; padding:16px; margin:12px 0; }
    .note { background:#e0f2fe; border-left:6px solid #0ea5e9; padding:12px; border-radius:6px; margin:12px 0; }
    .ok { background:#dcfce7; border-left:6px solid #22c55e; padding:12px; border-radius:6px; margin:12px 0; }
    .warn { background:#fee2e2; border-left:6px solid #ef4444; padding:12px; border-radius:6px; margin:12px 0; }
    .pill { display:inline-block; font-size:12px; background:#f1f5f9; border:1px solid #e2e8f0; padding:2px 8px; border-radius:999px; margin-right:6px; }
  </style>
</head>
<body>
<main>
  <h1>🚀 Firebase Hosting クイックスタートガイド</h1>
  <p><strong>目的:</strong> 手元の HTML/CSS/JS を Firebase にデプロイし、<b>独自ドメイン</b>＋<b>認証</b>＋<b>SharePoint 埋め込み</b>まで一気に到達するための最短ルート。</p>

  <h2>1. 前提チェック（5分）</h2>
  <div class="card">
    <ul>
      <li>Node.js（npm）インストール済み（<code>node -v</code> / <code>npm -v</code> で確認）</li>
      <li>Firebase CLI：<code>npm install -g firebase-tools</code></li>
      <li>Google アカウントの権限（Firebase プロジェクト作成/編集）</li>
      <li>独自ドメイン（例：<code>docs.cxj-collab.com</code>）の DNS を編集）</li>
    </ul>
  </div>

  <h2>2. 初回セットアップ（1プロジェクトにつき一度）</h2>
  <div class="card">
    <pre><code># 2-1) ログイン
firebase login

# 2-2) プロジェクトをこのフォルダに紐付け（プロンプトで選択）
firebase use --add

# 2-3) Hosting を初期化（public フォルダを選択）
firebase init hosting</code></pre>
    <p class="note">既にプロジェクト/Hostingがある場合は <code>init</code> を省略可。<br>リポジトリ構成例：</p>
    <pre><code>.
├─ firebase.json
└─ public/
   ├─ index.html
   ├─ login.html
   └─ docs/ ... （配信したいHTMLや画像など）</code></pre>
  </div>

  <h2>3. 動作確認 → デプロイ（最小ゴール）</h2>
  <div class="card">
    <pre><code># 3-1) ローカルで public/ を用意（index.html だけでもOK）
echo "&lt;h1&gt;Hello Firebase&lt;/h1&gt;" &gt; public/index.html

# 3-2) デプロイ（本番へ）
firebase deploy --only hosting</code></pre>
    <div class="ok"><b>成功のサイン:</b> <code>https://&lt;project-id&gt;.web.app</code> が表示できる。</div>
  </div>

  <h2>4. 独自ドメインをつなぐ（HTTPS 自動）</h2>
  <div class="card">
    <ol>
      <li>Firebase Console → Hosting →「<b>カスタムドメインを追加</b>」→ <code>docs.cxj-collab.com</code></li>
      <li>案内どおり DNS に <b>TXT</b>（所有権）と <b>A/AAAA</b> を追加</li>
      <li>数十分で証明書が “接続済み” に。以後は <code>https://docs.cxj-collab.com</code> を利用</li>
    </ol>
    <p class="note"><b>Authorized domains</b> にも <code>docs.cxj-collab.com</code> / <code>&lt;projectId&gt;.firebaseapp.com</code> を入れておくと、認証連携時に安心。</p>
  </div>

  <h2>5. 認証（2つの選択肢）</h2>
  <table>
    <tr><th>方式</th><th>概要</th><th>導線</th><th>備考</th></tr>
    <tr>
      <td><b>メールリンク（パスワードレス）</b></td>
      <td>社内メールにログインリンクを送る方式</td>
      <td>
        Authentication → サインイン方法 → <b>Email/Password = ON</b>、<b>Email link (passwordless) = ON</b><br>
        <code>sendSignInLinkToEmail()</code> を <code>login.html</code> で実装
      </td>
      <td>社内ゲートウェイで弾かれる場合は「送信ドメインを独自化」や「一時的に Email/Password 併用」で回避</td>
    </tr>
    <tr>
      <td><b>Email/Password（暫定・併用）</b></td>
      <td>コンソールでユーザー作成→初期パスでログイン</td>
      <td>Authentication → ユーザー →「ユーザーを追加」</td>
      <td>メールが届かない時の即回避に有効。あとで無効化可能</td>
    </tr>
  </table>

  <h2>6. 困ったら（あるある）</h2>
  <div class="warn">
    <ul>
      <li><b>auth/operation-not-allowed</b>：サインイン方法の該当項目が <b>ON</b> になっていない</li>
      <li><b>auth/unauthorized-domain</b>：<b>Authorized domains</b> に独自ドメインが未追加</li>
      <li><b>メールが届かない</b>：送信元を<b>独自ドメイン化</b>（DNSで SPF/DKIM を整合） or 一時的に <b>Email/Password 併用</b></li>
      <li><b>文字化け</b>：HTML を <b>UTF-8 で保存</b>し、<code>&lt;meta charset="utf-8"&gt;</code> を先頭へ</li>
    </ul>
  </div>

  <h2>7. 次の一手（任意）</h2>
  <div class="card">
    <ul>
      <li><b>自動デプロイ</b>：GitHub Actions で push → <code>firebase deploy</code></li>
      <li><b>直リンク厳格ガード</b>：Cloud Run を前段に置き、セッション Cookie 検証後にコンテンツ返却</li>
      <li><b>目次自動生成</b>：200ページのサイトマップをビルド時に生成</li>
    </ul>
  </div>

  <div class="ok">
    <b>まとめ:</b> <u>① init → ② public に置く → ③ deploy → ④ 独自ドメイン → ⑤ 認証 → ⑥ 埋め込み</u> の順で進めれば、最短で社内配信が完成します。
  </div>
</main>
</body>
</html>
